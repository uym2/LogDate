ggplot(d,aes(x=log(x),y=fx,color=f)) + geom_line() + xlim(-2,2)
tail(d)
log(1/4)
lg(1/4)
lg(4)
log(1/4)
log(1/2)
log(2)
log(4)
ggplot(d,aes(x=x,y=fx,color=f)) + geom_line()
ggplot(d,aes(x=log(x),y=fx,color=f)) + geom_line()
x = seq(1/4,4,1e-3)
d1 = data.frame(x,(lf(x)-lf(1))/lf(4))
d2 = data.frame(x,(lg(x)-lg(1))/lg(4))
d1$f = "LF"
d2$f = "LG"
colnames(d1) <- c("x","fx","f")
colnames(d2) <- c("x","fx","f")
d = rbind(d1,d2)
ggplot(d,aes(x=log(x),y=fx,color=f)) + geom_line()
ggplot(d,aes(x=x,y=fx,color=f)) + geom_line()
ggplot(d,aes(x=x,y=fx,color=f)) + geom_line() + scale_x_log10()
ggplot(d,aes(x=log(x),y=fx,color=f)) + geom_line()
log(4)
lf(4)
tail(d2)
ggplot(d,aes(x=x,y=fx,color=f)) + geom_line()
tail(d)
tail(d1)
d1 = data.frame(x,(lf(x)-lf(1))/lf(4))
tail(d1)
d1 = data.frame(x,(lf(x)-lf(1))/(lf(4)-lf(1)))
head(d1)
d1$f = "LF"
colnames(d1) = c("x","fx","LF")
d = rbind(d1,d2)
colnames(d1) = c("x","fx","f")
d = rbind(d1,d2)
ggplot(d,aes(x=x,y=fx,color=f)) + geom_line()
ggplot(d,aes(x=log(x),y=fx,color=f)) + geom_line()
lf(4) - lf(1)
lf(1)
lg(4) - lg(1)
library(treedater)
library(devtools)
install.packages("skyspline")
install.packages(skyspline)
install_github('emvolz-phylodynamics/skyspline')
library(skyspline)
fit.skyspline.ml()
?fit.skyspline.ml
? fit.skyspline.ml
setwd("~/my_gits/LogDate/Data/bio_data/Ebola/")
require("ggplot2")
require(skyspline)
mcc <- read.nexus("BEAST.tre")
mcc <- read.tree("BEAST.tre")
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
names(mcc.sts) <- mcc$tip.label
mcc.bdt <- DatedTree(mcc, mcc.sts, tol = 1/365)
mcc.t0 <- mcc.bdt$maxSampleTime - mcc.bdt$maxHeight
mcc.sky <- fit.skyspline.ml(mcc.bdt, death_rate_guess = 1/(15/365), t0=mcc.t0, y0_guess=1,  R0guess = 2, np_range = 2)
with(mcc.sky$demo.history, plot(times, pop.size, type='l'))
with(mcc.sky$demo.history, plot(times, reproduction.number, type='l'))
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
mcc$tip.label
library(ape)
library(magrittr)
library(lubridate)
library(skyspline)
library(treedater)
library(ggplot2)
mcc <- read.tree("BEAST.tre")
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
install.packages("lubridate")
library(lubridate)
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
install.packages("tidyverse")
library(lubridate)
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1)
names(mcc.sts) <- mcc$tip.label
mcc.bdt <- DatedTree(mcc, mcc.sts, tol = 1/365)
names(mcc.sts) <- mcc$tip.label
mcc.bdt <- DatedTree(mcc, mcc.sts, tol = 1/365)
mcc.sts
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
names(mcc.sts) <- mcc$tip.label
mcc.bdt <- DatedTree(mcc, mcc.sts, tol = 1/365)
mcc <- read.tree("BEAST.tre")
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
names(mcc.sts) <- mcc$tip.label
mcc.bdt <- DatedTree(mcc, mcc.sts, tol = 1/365)
mcc.t0 <- mcc.bdt$maxSampleTime - mcc.bdt$maxHeight
mcc.sky <- fit.skyspline.ml(mcc.bdt, death_rate_guess = 1/(15/365), t0=mcc.t0, y0_guess=1,  R0guess = 2, np_range = 2)
mcc.t0 <- mcc.bdt$maxSampleTime - mcc.bdt$maxHeight
mcc.sky <- fit.skyspline.ml(mcc.bdt, death_rate_guess = 1/(15/365), t0=mcc.t0, y0_guess=1,  R0guess = 2, np_range = 2)
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
mcc.sky <- fit.skyspline.ml(mcc.bdt, death_rate_guess = 1/(15/365), t0=mcc.t0, y0_guess=1,  R0guess = 2, np_range = 2)
mcc <- read.tree("BEAST.tre")
mcc.sts <- mcc$tip.label %>% strsplit(.,"|",fixed=TRUE) %>% lapply(.,tail,1) %>% ymd %>% decimal_date
names(mcc.sts) <- mcc$tip.label
mcc.bdt <- DatedTree(mcc, mcc.sts, tol = 1/365)
mcc.t0 <- mcc.bdt$maxSampleTime - mcc.bdt$maxHeight
mcc.sky <- fit.skyspline.ml(mcc.bdt, death_rate_guess = 1/(15/365), t0=mcc.t0, y0_guess=1,  R0guess = 2, np_range = 2)
with(mcc.sky$demo.history, plot(times, pop.size, type='l'))
require(skyspline)
(tre <- readRDS( system.file( 'extdata', 'demo.skyspline.hiv0.bdt.rds', package='skyspline') ))
plot( tre , show.tip =F)
GAMMA <- 1/10
fit <- fit.skyspline.ml( tre
, death_rate_guess = GAMMA
, R0guess = 2
)
with( fit$demo.history, plot( times, pop.size, log = 'y', type = 'l' ))
GAMMA <- 1/10
fit <- fit.skyspline.ml( tre
, death_rate_guess = GAMMA
, R0guess = 2
)
with( fit$demo.history, plot( times, pop.size, log = 'y', type = 'l' ))
fit <- fit.skyspline.ml( tre
, death_rate_guess = GAMMA
, R0guess = 2
, priors = list( death_rate = function(x) dlnorm( x, log(1/10), .5, log = T) )
)
require(skyspline)
(tre <- readRDS( system.file( 'extdata', 'demo.skyspline.hiv0.bdt.rds', package='skyspline') ))
GAMMA <- 1/10
fit <- fit.skyspline.ml( tre
, death_rate_guess = GAMMA
, R0guess = 2
)
setwd("~/my_gits/LogDate/Data/bio_data/H1N1/")
require(ggplot2)
d = data.frame(method=c("B_strict","B_lnorm"),
min=c(2008.15,2005.91),max=c(2008.96,2008.93),med=c(2008.74,2008.55),
lower=c(2008.56,2008.08),upper=c(2008.91,2008.83),org=c(2008.73,2008.50))
ggplot(d, aes(x=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = mid, upper = upper, ymax = max),
stat = "identity"
)
ggplot(d, aes(x=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity"
)
ggplot(d, aes(x=method,color=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic()
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic()
d = data.frame(method=c("LD","LD*","QPD","QPD*","RTT","RTT*","LF","B_phyML_strict","B_phyML_lnorm","B_strict","B_lnorm")),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
d = data.frame(method=c("LD","LD*","QPD","QPD*","RTT","RTT*","LF","B_phyML_strict","B_phyML_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic()
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom")
ggplot(d[d$method %in% c("QPD*","LF","B_phyML_strict","B_phyML_lnorm","B_strict","B_lnorm")], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom")
ggplot(d[d$method %in% c("QPD*","LF","B_phyML_strict","B_phyML_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom")
ggplot(d[d$method %in% c("QPD*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom")
d = data.frame(method=c("LD","LD*","QPD","LSD","RTT","RTT*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom")
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom") +
theme(axis.text.x = element_blank())
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom") +
theme(axis.text.x = element_blank(),axis.title.x = element_blank())
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom") +
theme(axis.text.x = element_blank(),axis.title.x = element_blank()+axis.ticks.x = element_blank())
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom") +
theme(axis.text.x = element_blank(),axis.title.x = element_blank()+axis.ticks.x =None)
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom") +
theme(axis.text.x = element_blank(),axis.title.x = element_blank()+axis.ticks.x="None")
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom") +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x="None")
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom") +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
levels(d$method) = d$method[8,9,10,11,1,2,3,4,5,6,7]
levels(d$method) = d$method[c(8,9,10,11,1,2,3,4,5,6,7)]
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
levels(d$method) = d$method[c(10,11,8,9,1,2,3,4,5,6,7)]
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
levels(d$method) = d$method[c(8,9,10,11,1,2,3,4,5,6,7)]
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
levels(d$method) = d$method[c(8,9,10,11,1,2,3,4,5,6,7)]
d$method
d$method = d$method[c(8,9,10,11,1,2,3,4,5,6,7)]
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
d = data.frame(method=c("LD","LD*","QPD","LSD","RTT","RTT*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
d$method = d$method[c(10,11,8,9,1,2,3,4,5,6,7)]
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
d = data.frame(method=c("LD","LD*","QPD","LSD","RTT","RTT*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
d$method[c(10,11,8,9,1,2,3,4,5,6,7)]
levels(d$method) = d$method[c(10,11,8,9,1,2,3,4,5,6,7)]
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
levels(d$method)
d$method = factor(levels(d$method)[c(10,11,8,9,1,2,3,4,5,6,7)])
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
d = data.frame(method=c("LD","LD*","QPD","LSD","RTT","RTT*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
d$method = factor(levels(d$method)[c(10,11,8,9,1,2,3,4,5,6,7)])
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
d = data.frame(method=c("LD","LD*","QPD","LSD","RTT","RTT*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
d$method = factor(d$method[c(10,11,8,9,1,2,3,4,5,6,7)])
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
d = data.frame(method=c("LD","LD*","QPD","LSD","RTT","RTT*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
d = data.frame(method=c("LD","LD*","QPD","LSD","RTT","RTT*","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.43,2008.93,2008.26,2008.86,2008.30,2008.63,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.21,2008.95,2007.95,2008.78,2008.34,2008.68,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2006.86,2008.29,2006.15,2008.13,2005.31,2007.75,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2007.24,2008.46,2006.76,2008.34,2006.51,2007.80,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2009.49,2009.19,2008.43,2008.95,2008.98,2009.10,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2010.30,2009.22,2008.68,2009.00,2009.00,2009.17,2009.01,2008.63,2008.32,2008.96,2008.93))
d$method = factor(d$method,levels=d$method[c(10,11,8,9,1,2,3,4,5,6,7)])
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank())
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired")
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired")
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "paired")
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired")
d = data.frame(method=c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.86,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.78,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2008.13,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2008.34,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2008.95,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2009.00,2009.01,2008.63,2008.32,2008.96,2008.93))
d$method = factor(d$method,levels=d$method[c(3,4,5,6,1,2)])
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired")
d = data.frame(method=c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),
org=c(2008.86,2008.86,2008.19,2007.55,2008.73,2008.50),
med=c(2008.78,2008.82,2008.21,2007.61,2008.74,2008.55),
min=c(2008.13,2008.02,2007.32,2003.54,2008.15,2005.91),
lower=c(2008.34,2008.37,2007.87,2006.77,2008.56,2008.08),
upper=c(2008.95,2008.99,2008.46,2008.16,2008.91,2008.83),
max = c(2009.00,2009.01,2008.63,2008.32,2008.96,2008.93))
d$method = factor(d$method,levels=d$method[c(5,6,3,4,1,2)])
ggplot(d[d$method %in% c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm"),], aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired")
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired")
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired2")
d$method = factor(d$method,levels=d$method[c(5,6,3,4,1,2)])
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_color_brewer(palette = "Paired2")
d$method = factor(d$method,levels=d$method[c(5,6,3,4,1,2)])
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_fill_brewer(palette = "Paired")
d = data.frame(method=c("LSD","LF","phyML_B_strict","phyML_B_lnorm","B_strict","B_lnorm","wLogDate"),
org=c(2008.86,2008.86,2008.19,2007.55,2008.73,2008.50,2008.66),
med=c(2008.78,2008.82,2008.21,2007.61,2008.74,2008.55,2008.91),
min=c(2008.13,2008.02,2007.32,2003.54,2008.15,2005.91,2004.99),
lower=c(2008.34,2008.37,2007.87,2006.77,2008.56,2008.08,2007.03),
upper=c(2008.95,2008.99,2008.46,2008.16,2008.91,2008.83,2009.19),
max = c(2009.00,2009.01,2008.63,2008.32,2008.96,2008.93,2009.22))
d$method = factor(d$method,levels=d$method[c(5,6,3,4,1,2,7)])
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_fill_brewer(palette = "Paired")
ggplot(d, aes(x=method,fill=method)) +
geom_point(aes(y=org)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_fill_brewer(palette = "Paired")
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_fill_brewer(palette = "Paired") + geom_point(aes(y=org))
ggplot(d, aes(x=method,fill=method)) +
geom_boxplot(
aes(ymin = min, lower = lower, middle = med, upper = upper, ymax = max),
stat = "identity" ) + geom_point(aes(y=org)) +
theme_classic() + theme(legend.position = "bottom",legend.title = element_blank()) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),axis.ticks.x=element_blank()) +
scale_fill_brewer(palette = "Paired")
ggsave("tMRCA.pdf",height = 3,width = 3)
ggsave("tMRCA.pdf",height = 3,width = 3.5)
ggsave("tMRCA.pdf",height = 3,width = 4)
ggsave("tMRCA.pdf",height = 3,width = 4.5)
setwd("~/my_gits/LogDate/Data/bio_data/H1N1/")
require("ggplot2")
d = read.table("ltt_data.txt",header = T)
head(d)
setwd("~/my_gits/LogDate/Data/bio_data/Ebola/")
require("ggplot2")
d = read.table("ltt_data.txt",header = T)
ggplot(d,aes(x=time,y=lineages,color=method)) + geom_line() + theme_classic() +
scale_color_manual(values=c("#1f78b4","#e31a1c","#fb9a99","#fdbf6f")) +
theme(legend.position = "None")
ggsave("Ebola_ltt.pdf",height = 3,width = 3)
setwd("~/my_gits/LogDate/Data/bio_data/H1N1/")
require("ggplot2")
d = read.table("ltt_data.txt",header = T)
ggplot(d,aes(x=time,y=lineages,color=method)) + geom_line() + theme_classic() +
scale_color_manual(values=c("#e31a1c","#fb9a99","#fdbf6f")) +
theme(legend.position = "None")
ggplot(d,aes(x=time,y=lineages,color=method)) + geom_line() + theme_classic() +
scale_color_manual(values=c("#e31a1c","#fb9a99","#fdbf6f"))
ggplot(d,aes(x=time,y=lineages,color=method)) + geom_line() + theme_classic() +
scale_color_manual(values=c("#e31a1c","#fb9a99","#fdbf6f")) +
theme(legend.position = "None")
ggsave("H1N1_ltt.pdf",height = 3,width = 3)
setwd("~/my_gits/LogDate/Data/bio_data/HIV/")
require("ggplot2")
d = read.table("ltt_data.txt",header = T)
ggplot(d,aes(x=time,y=lineages,color=method)) + geom_line() + theme_classic() +
scale_color_manual(values=c("#e31a1c","#fb9a99","#fdbf6f")) +
theme(legend.position = "None")
setwd("~/my_gits/LogDate/Data/bio_data/HIV/")
require("ggplot2")
d = read.table("ltt_data.txt",header = T)
ggplot(d,aes(x=time,y=lineages,color=method)) + geom_line() + theme_classic() +
scale_color_manual(values=c("#e31a1c","#fb9a99","#fdbf6f"))
setwd("~/my_gits/LogDate/Data/bio_data/HIV/")
require("ggplot2")
d = read.table("ltt_data.txt",header = T)
ggplot(d,aes(x=time,y=lineages,color=method)) + geom_line() + theme_classic() +
scale_color_manual(values=c("#e31a1c","#fb9a99","#fdbf6f")) +
theme(legend.position = "None")
ggsave("Ebola_ltt.pdf",height = 3,width = 3)
ggsave("HIV_ltt.pdf",height = 3,width = 3)
